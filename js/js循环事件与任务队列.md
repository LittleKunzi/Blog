## 任务队列与事件循环

### 任务队列

 js是**单线程**的，单线程意味着所有的任务需要排队。任务分为**同步任务（synchronous）**和**异步任务（asynchronous）**。

同步任务会直接放到主线程中执行，而异步任务则会被放在**任务队列（task queue）**中，当任务队列通知该异步任务可以进入主线程进行执行的时候，该异步任务才会进入主线程执行。



**同步任务先执行，注意：Promise构造函数中的代码也是同步任务**

微任务：Promise，async/await等  ，

宏任务：setTimeout，setInterval，DOM事件，AJAX请求等

微任务——>Dom渲染——>宏任务



执行顺序：

1.同步任务

2.process.nextTick

3.微任务

4.宏任务

5.setImmediate

### 事件循环

事件循环：可以理解为不断的检测任务队列里面有没有东西。

在事件循环中，并不是把所有微任务执行完后在执行所有的宏任务。而是通过事件循环的机制，不断“发现”微任务和宏任务。

每一次事件循环的任务执行顺序为：宏任务（因为script是打头的）——>（在调用栈为空时，事件循环优先执行微任务）微任务——>渲染——>宏任务



setImmediate是当前事件循环结束后执行。